{"pageProps":{"contentHtml":"<html><head></head><body><h1>SlimFaas Kafka Connector <a href=\"https://hub.docker.com/r/axaguildev/slimfaas-kafka/builds\"><img src=\"https://img.shields.io/docker/pulls/axaguildev/slimfaas-kafka.svg?label=docker+pull+slimfaas-kafka\" alt=\"Docker SlimFaas\"></a> <a href=\"https://hub.docker.com/r/axaguildev/slimfaas/builds\"><img src=\"https://img.shields.io/docker/image-size/axaguildev/slimfaas-kafka?label=image+size+slimfaas-kafka\" alt=\"Docker Image Size\"></a> <a href=\"https://hub.docker.com/r/axaguildev/slimfaas-kafka/builds\"><img src=\"https://img.shields.io/docker/v/axaguildev/slimfaas-kafka?sort=semver&amp;label=latest+version+slimfaas-kafka\" alt=\"Docker Image Version\"></a> <a href=\"https://artifacthub.io/packages/search?repo=slimfaas-kafka\"><img src=\"https://img.shields.io/endpoint?url=https://artifacthub.io/badge/repository/slimfaas-kafka\" alt=\"Artifact Hub\"></a></h1>\n<p>SlimFaas-Kafka is a lightweight micro‚Äëservice designed to <strong>monitor Kafka topics</strong> and automatically <strong>wake up SlimFaas functions</strong> when messages arrive or when recent Kafka activity indicates the function should stay awake.\nIt enables full event‚Äëdriven autoscaling of SlimFaas functions based on Kafka queues ‚Äî without consuming the messages itself.</p>\n<hr>\n<h2>üöÄ Overview</h2>\n<p>SlimFaas-Kafka acts as a <strong>sidecar orchestration component</strong> that:</p>\n<ol>\n<li><strong>Watches Kafka topics</strong> for:\n<ul>\n<li>Pending messages (lag)</li>\n<li>Recent consumption activity (progress in committed offsets)</li>\n</ul>\n</li>\n<li><strong>Decides when a SlimFaas function should be started or kept alive</strong></li>\n<li><strong>Triggers SlimFaas wake‚Äëup API</strong> to scale functions from 0 ‚Üí N pods</li>\n</ol>\n<p>SlimFaasKafka <strong>never consumes messages</strong> from your topics.\nIt only queries:</p>\n<ul>\n<li>high watermark offsets (latest message index per partition)</li>\n<li>committed consumer group offsets (only if Kafka ACLs allow it)</li>\n</ul>\n<p>This means your message streams remain <strong>untouched</strong> and your existing consumers operate normally.</p>\n<hr>\n<h2>üèó Architecture</h2>\n<p>Below is the logical architecture:</p>\n<pre><code class=\"hljs\">Kafka Topics  ‚Üí  SlimFaasKafka  ‚Üí  SlimFaas Orchestrator  ‚Üí  <span class=\"hljs-keyword\">Function</span> <span class=\"hljs-title\">Pods</span>\n                    ‚Üë   ‚Üì                         ‚Üë\n       Metadata &amp; Offsets   Wake‚Äëup events        |\n</code></pre>\n<h3>Components</h3>\n<div class=\"table-scroll\" role=\"region\" aria-label=\"Scrollable table\" tabindex=\"0\"><table>\n<thead>\n<tr>\n<th>Component</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>SlimFaasKafka</strong></td>\n<td>Monitors Kafka lag &amp; activity; sends wake signals</td>\n</tr>\n<tr>\n<td><strong>Kafka Broker</strong></td>\n<td>Holds the messages and consumer groups</td>\n</tr>\n<tr>\n<td><strong>SlimFaas</strong></td>\n<td>Manages function replicas and performs the actual autoscaling</td>\n</tr>\n<tr>\n<td><strong>Function Pods</strong></td>\n<td>Stateless workers that process Kafka messages</td>\n</tr>\n</tbody>\n</table></div>\n<p>SlimFaasKafka integrates with SlimFaas by calling:</p>\n<pre><code class=\"hljs\">POST <span class=\"hljs-regexp\">/wake-functions/</span>{functionName}\n</code></pre>\n<p>Each time:</p>\n<ul>\n<li>pending messages ‚â• threshold</li>\n<li>OR recent activity detected</li>\n</ul>\n<hr>\n<h2>üîÑ How SlimFaasKafka decides to wake up a function</h2>\n<p>SlimFaasKafka evaluates each <em>binding</em> (topic + consumer group + function) by computing:</p>\n<h3>1. Pending messages</h3>\n<p>Based on:</p>\n<pre><code class=\"hljs\"><span class=\"hljs-attr\">pending</span> = high_watermark - committed_<span class=\"hljs-literal\">off</span>set\n</code></pre>\n<p>If AdminClient (ACL) doesn‚Äôt allow offset read, fallback uses:</p>\n<pre><code class=\"hljs\"><span class=\"hljs-attribute\">pending</span> <span class=\"hljs-operator\">=</span> high_watermarks\n</code></pre>\n<p><em>(less accurate but safe)</em></p>\n<h3>2. Recent activity</h3>\n<p>SlimFaasKafka tracks changes in committed offsets.\nIf offsets increase, it means a consumer worked recently.</p>\n<p>You can configure:</p>\n<ul>\n<li><strong>minimum delta</strong> that qualifies as activity</li>\n<li><strong>activity keep‚Äëalive window</strong> to keep the function awake after processing messages</li>\n</ul>\n<h3>3. Cooldown</h3>\n<p>To avoid spamming SlimFaas, a wake‚Äëup cooldown per (topic, group) is applied.</p>\n<hr>\n<h2>üß© Bindings</h2>\n<p>A binding describes:</p>\n<ul>\n<li>which Kafka topic to monitor</li>\n<li>which consumer group represents the function‚Äôs consumption</li>\n<li>which SlimFaas function should be woken up</li>\n</ul>\n<p>Example binding:</p>\n<pre><code class=\"language-json hljs\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">\"Topic\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"fibo-public\"</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"ConsumerGroupId\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"fibonacci-listener-group\"</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"FunctionName\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"fibonaccilistener\"</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"MinPendingMessages\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"CooldownSeconds\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">30</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"ActivityKeepAliveSeconds\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">60</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">\"MinConsumedDeltaForActivity\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">1</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>\n<hr>\n<h2>‚öôÔ∏è Configuration (Environment Variables)</h2>\n<p>SlimFaasKafka uses three configuration sections:</p>\n<hr>\n<h3>1. <strong>Kafka Settings</strong></h3>\n<div class=\"table-scroll\" role=\"region\" aria-label=\"Scrollable table\" tabindex=\"0\"><table>\n<thead>\n<tr>\n<th>Env Var</th>\n<th>Meaning</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Kafka__BootstrapServers</code></td>\n<td>e.g. <code>kafka:9092</code>. MUST NOT be <code>localhost</code> inside Docker.</td>\n</tr>\n<tr>\n<td><code>Kafka__ClientId</code></td>\n<td>Name sent to Kafka broker</td>\n</tr>\n<tr>\n<td><code>Kafka__CheckIntervalSeconds</code></td>\n<td>How often to check queues</td>\n</tr>\n<tr>\n<td><code>Kafka__KafkaTimeoutSeconds</code></td>\n<td>Query timeout</td>\n</tr>\n<tr>\n<td><code>Kafka__AllowAutoCreateTopics</code></td>\n<td>Allow auto topic creation</td>\n</tr>\n</tbody>\n</table></div>\n<hr>\n<h3>2. <strong>SlimFaas Settings</strong></h3>\n<div class=\"table-scroll\" role=\"region\" aria-label=\"Scrollable table\" tabindex=\"0\"><table>\n<thead>\n<tr>\n<th>Env Var</th>\n<th>Meaning</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>SlimFaas__BaseUrl</code></td>\n<td>URL of the SlimFaas API inside Docker (e.g. <code>http://slimfaas:30021</code>)</td>\n</tr>\n<tr>\n<td><code>SlimFaas__WakeUpPathTemplate</code></td>\n<td>Wake endpoint, default: <code>/functions/{functionName}/wake</code></td>\n</tr>\n<tr>\n<td><code>SlimFaas__HttpTimeoutSeconds</code></td>\n<td>HTTP timeout</td>\n</tr>\n</tbody>\n</table></div>\n<hr>\n<h3>3. <strong>SlimFaasKafka Bindings</strong></h3>\n<p>Each binding is configured through indexed env vars:</p>\n<pre><code class=\"hljs\"><span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__Topic</span>=fibo-public\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__ConsumerGroupId</span>=fibonacci-listener-group\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__FunctionName</span>=fibonaccilistener\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__MinPendingMessages</span>=<span class=\"hljs-number\">1</span>\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__CooldownSeconds</span>=<span class=\"hljs-number\">30</span>\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__ActivityKeepAliveSeconds</span>=<span class=\"hljs-number\">60</span>\n<span class=\"hljs-attr\">SlimFaasKafka__Bindings__0__MinConsumedDeltaForActivity</span>=<span class=\"hljs-number\">1</span>\n</code></pre>\n<p>You can add more bindings:</p>\n<pre><code class=\"hljs\"><span class=\"hljs-attribute\">SlimFaasKafka__Bindings__1__Topic</span>=orders\n<span class=\"hljs-attribute\">SlimFaasKafka__Bindings__1__ConsumerGroupId</span>=orders-group\n<span class=\"hljs-attribute\">SlimFaasKafka__Bindings__1__FunctionName</span>=processorders\n<span class=\"hljs-built_in\">..</span>.\n</code></pre>\n<hr>\n<h2>üì° Metrics Endpoint</h2>\n<p>SlimFaasKafka exposes Prometheus metrics at:</p>\n<pre><code class=\"hljs\">/metrics\n</code></pre>\n<p>Metrics include:</p>\n<div class=\"table-scroll\" role=\"region\" aria-label=\"Scrollable table\" tabindex=\"0\"><table>\n<thead>\n<tr>\n<th>Metric</th>\n<th>Meaning</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>slimfaaskafka_wakeups_total</code></td>\n<td>Number of wake-ups per binding</td>\n</tr>\n<tr>\n<td><code>slimfaaskafka_pending_messages</code></td>\n<td>Pending messages per topic/group/function</td>\n</tr>\n<tr>\n<td><code>slimfaaskafka_last_activity_timestamp_seconds</code></td>\n<td>Last activity time</td>\n</tr>\n</tbody>\n</table></div>\n<hr>\n<h2>üê≥ Running with Docker Compose</h2>\n<p>Minimal example:</p>\n<pre><code class=\"language-yaml hljs\">slimkafka:\n  build:\n    context: ./src/SlimFaasKafka\n    dockerfile: Dockerfile\n  environment:\n    - <span class=\"hljs-attribute\">Kafka__BootstrapServers</span>=kafka:9092\n    - <span class=\"hljs-attribute\">Kafka__CheckIntervalSeconds</span>=5\n    - <span class=\"hljs-attribute\">SlimFaas__BaseUrl</span>=http://slimfaas:30021\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__Topic</span>=fibo-public\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__ConsumerGroupId</span>=fibonacci-listener-group\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__FunctionName</span>=fibonaccilistener\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__MinPendingMessages</span>=1\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__CooldownSeconds</span>=30\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__ActivityKeepAliveSeconds</span>=60\n    - <span class=\"hljs-attribute\">SlimKafka__Bindings__0__MinConsumedDeltaForActivity</span>=1\n  networks:\n    - slimfaas-net\n</code></pre>\n<p>Make sure:</p>\n<ul>\n<li>SlimFaas and SlimFaasKafka are on the same Docker network</li>\n<li>Kafka‚Äôs <code>ADVERTISED_LISTENERS</code> does <em>not</em> include <code>localhost</code></li>\n<li>SlimFaas is reachable at the internal hostname (<code>slimfaas:30021</code>)</li>\n</ul>\n<hr>\n<h2>üö¶ Startup Sequence</h2>\n<ol>\n<li>Kafka starts</li>\n<li>SlimFaas starts</li>\n<li>SlimFaasKafka starts</li>\n<li>SlimFaasKafka connects to Kafka</li>\n<li>SlimFaasKafka monitors the configured topics</li>\n<li>If messages arrive ‚Üí SlimFaasKafka calls SlimFaas ‚Üí SlimFaas scales function up</li>\n</ol>\n<hr>\n<h2>‚úî Summary</h2>\n<p>SlimFaasKafka enables:</p>\n<ul>\n<li><strong>Zero‚Äëto‚ÄëN autoscaling</strong> for Kafka-driven functions</li>\n<li>Without consuming messages</li>\n<li>With monitoring of lag and recent activity</li>\n<li>Full Prometheus visibility</li>\n<li>Easy configuration through environment variables</li>\n<li>Works perfectly inside Docker or Kubernetes</li>\n</ul>\n<p>It is the recommended companion service for <strong>event-driven SlimFaas workloads</strong>.</p>\n</body></html>","metadata":{}},"__N_SSG":true}